<!DOCTYPE html>
<html lang="it-IT">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Calendario</title>
        <style>
            body {
                font-family: 'Open Sans', sans-serif;
                text-align: center;
                background: linear-gradient(to left, #b9cfec,  #b4c8d4); 
                margin: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                height: 100vh;
            }

            label {
                margin-bottom: 10px;
                font-weight: bold;
                font-size: 18px;
                color: #ffffff;
            }

            h2 {
                text-align: center;
                color: #2370A6;
                font-size: 36px;
                margin-bottom: 33px;
                font-family: 'Open Sans', sans-serif;
            }

            #calendar-container {
                width: 1100px;
                height: 770px;
                margin: 4% auto;
                background: linear-gradient(to bottom, #b4c8d4, #3979cc);
                padding: 2%;
                border-radius: 15px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }

            #month, #year {
                margin-right: 10px;
                width: min-content;
                padding: 10px;
                margin-bottom: 20px;
                box-sizing: border-box;
                border:1px solid #ccc;
                border-radius: 3px;
            }

            img{
                display: block;
                margin: 0 auto;
                width: 243px;
                height: 138px;
                padding: 20px;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            th, td {
                border: 1px solid #ddd;
                padding: 20px;
                text-align: center;
                cursor: pointer;
                font-weight: bold;
            }

            th {
                background-color: #f2f2f2;
            }

            .popup {
                display: none;
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                padding: 20px;
                background-color: #fff;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                z-index: 2;
                border-radius: 10px;
                width: 300px; /* Larghezza fissa della finestra popup */
            }

            .popup-background {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 1;
            }

            .close {
                position: absolute;
                top: 10px;
                right: 10px;
                cursor: pointer;
            }
        </style>
    </head>
    <body>

        <form id="calendar-container">
            <img src="../img/LogoGiorgi.png" alt="Logo">
            <label for="month">Seleziona il mese:</label>
            <select id="month" onchange="updateCalendar()">
                <option value="0">Gennaio</option>
                <option value="1">Febbraio</option>
                <option value="2">Marzo</option>
                <option value="3">Aprile</option>
                <option value="4">Maggio</option>
                <option value="5">Giugno</option>
                <option value="6">Luglio</option>
                <option value="7">Agosto</option>
                <option value="8">Settembre</option>
                <option value="9">Ottobre</option>
                <option value="10">Novembre</option>
                <option value="11">Dicembre</option>
            </select>

            <label for="year">Seleziona l'anno:</label>
            <select id="year" onchange="updateCalendar()">
                <!-- Imposta gli anni dal 2023 al 2030 -->
                <option value="2023">2023</option>
                <option value="2024">2024</option>
            </select>

            <div id="calendar-container-inner">
                <div id="calendar"></div>
                </div>
                    <div id="popup-background" class="popup-background" onclick="closePopup()"></div>
                    <div id="popup" class="popup">
                    <span class="close" onclick="closePopup()">X</span>
                    <p id="selectedDate"></p> 
                </div>
        </form>

        <script>
            function generateCalendar(year, month) {
                const calendar = document.getElementById("calendar");
                // const yearDropdown = document.getElementById("year");
                const months = [
                "Gennaio", "Febbraio", "Marzo", "Aprile", "Maggio", "Giugno",
                "Luglio", "Agosto", "Settembre", "Ottobre", "Novembre", "Dicembre"
                ];


                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const firstDayIndex = new Date(year, month, 1).getDay();
                const lastDayIndex = new Date(year, month, daysInMonth).getDay();

                let calendarHTML = `<h2>${months[month]} ${year}</h2>
                <table>
                <tr>
                <th>Dom</th>
                <th>Lun</th>
                <th>Mar</th>
                <th>Mer</th>
                <th>Gio</th>
                <th>Ven</th>
                <th>Sab</th>
                
                </tr>
                <tr>`;

                for (let i = 0; i < firstDayIndex; i++) {
                    calendarHTML += "<td></td>";
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    calendarHTML += `<td onclick="openPopup(${i})">${i}</td>`;
                    if ((i + firstDayIndex) % 7 === 0) {
                        calendarHTML += "</tr><tr>";
                    }
                }

                for (let i = lastDayIndex + 1; i < 7; i++) {
                    calendarHTML += "<td></td>";
                }

                calendarHTML += "</tr></table>";
                calendar.innerHTML = calendarHTML;
            }

            function openPopup() {
                window.open("./prenotazione.html");
            }

            function closePopup() {
                const popup = document.getElementById("popup");
                const popupBackground = document.getElementById("popup-background");

                popup.style.display = "none";
                popupBackground.style.display = "none";
            }

            function updateCalendar() {
                const year = parseInt(document.getElementById("year").value);
                const month = parseInt(document.getElementById("month").value);
                generateCalendar(year, month);
            }

            // Iniziale generazione del calendario per il mese e l'anno corrente
            const currentDate = new Date();
            document.getElementById("month").value = currentDate.getMonth().toString();
            document.getElementById("year").value = currentDate.getFullYear().toString();
            generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
        </script>

        </body>
</html>
